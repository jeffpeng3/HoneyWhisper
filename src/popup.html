<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Controls - HoneyWhisper</title>
  <style>
    body { font-family: system-ui, sans-serif; padding: 16px; width: 320px; margin: 0; }
    h1 { font-size: 1.25em; margin: 0 0 16px 0; display: flex; align-items: center; justify-content: space-between; }
    .btn-main { 
        width: 100%; padding: 12px; border: none; border-radius: 8px; 
        font-size: 1.1em; font-weight: bold; cursor: pointer; transition: background 0.2s;
        display: flex; align-items: center; justify-content: center; gap: 8px;
    }
    .btn-start { background: #3b82f6; color: white; }
    .btn-start:hover { background: #2563eb; }
    .btn-stop { background: #ef4444; color: white; }
    .btn-stop:hover { background: #dc2626; }
    
    .status-badge { font-size: 0.8em; padding: 4px 8px; background: #eee; border-radius: 12px; font-weight: normal; }
    .status-recording { background: #fecaca; color: #dc2626; }
    
    .settings { margin-top: 24px; border-top: 1px solid #eee; padding-top: 16px; }
    label { display: block; margin-bottom: 6px; font-size: 0.9em; font-weight: 500; color: #374151; }
    select, input[type="range"] { width: 100%; padding: 6px; border-radius: 4px; border: 1px solid #ccc; margin-bottom: 12px; box-sizing: border-box; }
    .note { font-size: 0.8em; color: #6b7280; margin-top: -8px; margin-bottom: 12px; }
  </style>
</head>
<body>
  <h1>
    HoneyWhisper
    <span id="statusBadge" class="status-badge">Ready</span>
  </h1>

  <div id="activeTabInfo" style="display:none; margin-bottom: 12px; font-size: 0.9em; padding: 8px; background: #f3f4f6; border-radius: 6px;">
      Capturing: <a href="#" id="tabLink" style="color: #2563eb; text-decoration: none; font-weight: 500;">Tab Name</a>
  </div>

  <div id="progressContainer" style="display:none; margin-bottom: 16px;">
      <div style="display:flex; justify-content:space-between; font-size:0.85em; margin-bottom:4px; color:#555;">
          <span id="progressText">Loading Model...</span>
          <span id="progressPercent">0%</span>
      </div>
      <div style="background:#e5e7eb; height:6px; border-radius:3px; overflow:hidden;">
          <div id="progressBar" style="background:#3b82f6; height:100%; width:0%; transition: width 0.2s;"></div>
      </div>
  </div>

  <button id="btnState" class="btn-main btn-start">
    <span>Start Captioning</span>
  </button>

  <div class="settings">
    <label for="modelId">Model (onnx-community)</label>
    <select id="modelId">
      <option value="onnx-community/whisper-tiny">Tiny (Fastest, Low VRAM)</option>
      <option value="onnx-community/whisper-base">Base (Balanced)</option>
      <option value="onnx-community/whisper-small">Small (High Quality, ~2GB VRAM)</option>
      <option value="onnx-community/distil-small.en">Distil-Small English (Fast & Accurate)</option>
      <option value="onnx-community/whisper-medium-ONNX">Medium (Very High Quality, ~5GB VRAM)</option>
      <option value="onnx-community/whisper-large-v3-turbo">Large v3 Turbo (Best, ~6GB VRAM)</option>
    </select>

    <label for="language">Language</label>
    <select id="language">
      <option value="en">English</option>
      <option value="zh">Chinese (中文)</option>
      <option value="ja">Japanese (日本語)</option>
      <option value="es">Spanish</option>
      <option value="fr">French</option>
      <option value="de">German</option>
      <option value="ko">Korean</option>
      <option value="auto">Auto Detect</option>
    </select>

    <label for="historyLines">History Lines (0-5)</label>
    <input type="number" id="historyLines" min="0" max="5" value="1">

    <label for="fontSize">Subtitle Size</label>
    <input type="range" id="fontSize" min="16" max="48" value="24">
    <div class="note">Preview: <span id="fontSizePreview" style="background:#000; color:#fff; padding:2px 4px; border-radius:4px;">Abc</span></div>
  </div>

  <div style="margin-top:16px; border-top:1px solid #eee; padding-top:12px;">
      <details>
          <summary style="font-size:0.85em; color:#777; cursor:pointer;">Debug Tools</summary>
          <div style="margin-top:8px;">
              <button id="btnClearCache" style="width:100%; padding:8px; background:#fca5a5; color:#7f1d1d; border:none; border-radius:4px; font-size:0.9em; cursor:pointer;">
                  Clear All Downloaded Models
              </button>
              
              <button id="btnListModels" style="width:100%; margin-top:8px; padding:8px; background:#e5e7eb; color:#374151; border:none; border-radius:4px; font-size:0.9em; cursor:pointer;">
                  Show Installed Models
              </button>
              <div id="modelsList" style="margin-top:8px; font-size:0.8em; color:#555; word-break:break-all;"></div>

              <p class="note" style="margin-top:4px;">This will free up disk space. You will need to re-download models next time.</p>
          </div>
      </details>
  </div>

  <script type="module" src="popup.js"></script>
</body>
</html>
